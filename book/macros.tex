% ============================================
% CUSTOM MACROS AND ENVIRONMENTS
% ============================================

% Emoji and Special Character Replacements
% Note: \checkmark is already defined by amssymb package
% With XeLaTeX, Unicode characters work natively - no need for DeclareUnicodeCharacter
% However, we need a font that supports emojis
% Using Symbola for better emoji coverage
\newfontfamily\emojifont{Symbola}

% Map specific emojis to the emoji font
% Use \mdseries (medium/normal) and \upshape (upright) to avoid looking for Bold/Italic emoji variants
\newunicodechar{â­}{{\emojifont\mdseries\upshape\textcolor{orange}{â˜†}}}
\newunicodechar{â˜†}{{\emojifont\mdseries\upshape â˜†}}
\newunicodechar{â˜•}{{\emojifont\mdseries\upshape â˜•}}
\newunicodechar{ğŸ’¡}{{\emojifont\mdseries\upshape ğŸ’¡}}
\newunicodechar{âŒ}{{\emojifont\mdseries\upshape âŒ}}
\newunicodechar{âœ“}{{\emojifont\mdseries\upshape âœ“}}
\newunicodechar{ğŸ”Š}{{\emojifont\mdseries\upshape ğŸ”Š}}
\newunicodechar{âš }{{\emojifont\mdseries\upshape âš }}
\newunicodechar{âœ…}{{\emojifont\mdseries\upshape âœ…}}
\newunicodechar{ğŸš«}{{\emojifont\mdseries\upshape ğŸš«}}
\newunicodechar{ğŸ‘‡}{{\emojifont\mdseries\upshape ğŸ‘‡}}
\newunicodechar{ğŸ‘‰}{{\emojifont\mdseries\upshape ğŸ‘‰}}
\newunicodechar{ğŸ‘ˆ}{{\emojifont\mdseries\upshape ğŸ‘ˆ}}
\newunicodechar{ğŸ‘}{{\emojifont\mdseries\upshape ğŸ‘}}
\newunicodechar{ğŸ‘}{{\emojifont\mdseries\upshape ğŸ‘}}
\newunicodechar{ğŸ¤”}{{\emojifont\mdseries\upshape ğŸ¤”}}
\newunicodechar{Ëˆ}{{\ipafont Ëˆ}}
\newunicodechar{ğŸ‡¬}{{\emojifont\mdseries\upshape ğŸ‡¬}}
\newunicodechar{ğŸ‡§}{{\emojifont\mdseries\upshape ğŸ‡§}}
\newunicodechar{ğŸ‡ª}{{\emojifont\mdseries\upshape ğŸ‡ª}}
\newunicodechar{ğŸ‡¸}{{\emojifont\mdseries\upshape ğŸ‡¸}}
\newunicodechar{â‰ }{\ensuremath{\neq}}



\newcommand{\crossmark}{\textbf{[INCORRECT]}}

% IPA Font
\newfontfamily\ipafont{DejaVu Sans}

% Common IPA symbols mapping
\newunicodechar{Éª}{{\ipafont Éª}}
\newunicodechar{É’}{{\ipafont É’}}
\newunicodechar{ÊŒ}{{\ipafont ÊŒ}}
\newunicodechar{Ë}{{\ipafont Ë}}
\newunicodechar{Î¸}{{\ipafont Î¸}}
\newunicodechar{Êƒ}{{\ipafont Êƒ}}
\newunicodechar{Ã°}{{\ipafont Ã°}}
\newunicodechar{É™}{{\ipafont É™}}
\newunicodechar{Å‹}{{\ipafont Å‹}}
\newunicodechar{Éœ}{{\ipafont Éœ}}
\newunicodechar{É”}{{\ipafont É”}}
\newunicodechar{ÊŠ}{{\ipafont ÊŠ}}
\newunicodechar{É‘}{{\ipafont É‘}}
\newunicodechar{Ã¦}{{\ipafont Ã¦}}
\newunicodechar{É›}{{\ipafont É›}}

% More Emojis
\newunicodechar{ğŸ“š}{{\emojifont\mdseries\upshape ğŸ“š}}
\newunicodechar{ğŸ“±}{{\emojifont\mdseries\upshape ğŸ“±}}
\newunicodechar{âœ—}{{\emojifont\mdseries\upshape âœ—}}
\newunicodechar{ï¸}{{\emojifont\mdseries\upshape ï¸}} % Variation Selector 16

% Colors
\definecolor{primaryColor}{RGB}{0, 102, 204}    % Blue
\definecolor{secondaryColor}{RGB}{255, 153, 51} % Orange
\definecolor{accentColor}{RGB}{51, 153, 102}    % Green
\definecolor{lightGray}{RGB}{245, 245, 245}
\definecolor{kaplanPurple}{HTML}{000080}
\definecolor{kaplanLight}{HTML}{EDE7F6}

% Box for Vocabulary
\newtcolorbox{vocabbox}[1][]{
    colback=lightGray,
    colframe=primaryColor,
    fonttitle=\bfseries,
    title=Vocabulary Focus,
    #1
}

% Box for Grammar
\newtcolorbox{grammarbox}[1][]{
    colback=white,
    colframe=secondaryColor,
    fonttitle=\bfseries,
    title=Grammar Point,
    #1
}

% Box for Examples
\newtcolorbox{examplebox}[1][]{
    colback=white,
    colframe=accentColor,
    fonttitle=\bfseries,
    title=Examples,
    #1
}

% Box for Dialogues/Reading
\newtcolorbox{readingbox}[1][]{
    colback=lightGray,
    colframe=black,
    fonttitle=\bfseries,
    title=Reading Context,
    #1
}

% Box for Notes
\newtcolorbox{notebox}[1][]{
    colback=kaplanLight,
    colframe=kaplanPurple,
    fonttitle=\bfseries,
    title=Note,
    #1
}

% Box for Tips
\newtcolorbox{tipbox}[1][]{
    colback=white,
    colframe=accentColor,
    fonttitle=\bfseries,
    title=Tip,
    #1
}

% Box for Warnings
\newtcolorbox{warningbox}[1][]{
    colback=white,
    colframe=red,
    fonttitle=\bfseries,
    title=Warning,
    #1
}

% Command for translations
\newcommand{\trans}[1]{\textit{\color{gray} (#1)}}

% Command for key terms
\newcommand{\keyterm}[1]{\textbf{\color{primaryColor} #1}}

% Command for British English terms
\newcommand{\britishterm}[1]{\textcolor{blue}{\textbf{#1}}}

% Command for American English terms (for comparison)
\newcommand{\americanterm}[1]{\textcolor{red}{\textit{#1}}}

% Command for CEFR levels
\newcommand{\cefrlevel}[1]{\textbf{\color{accentColor} [CEFR: #1]}}

% Command for correct answers
\newcommand{\correct}{\textcolor{green!60!black}{\checkmark}}

% Command for incorrect answers
\newcommand{\incorrect}{\textcolor{red}{\textbf{X}}}

% Icons and symbols (using Unicode with XeLaTeX)
\newcommand{\britishflag}{{\emojifont\mdseries\upshape ğŸ‡¬ğŸ‡§}}
\newcommand{\speakicon}{{\emojifont\mdseries\upshape ğŸ—£ï¸}}
\newcommand{\listenicon}{{\emojifont\mdseries\upshape ğŸ§}}
\newcommand{\writeicon}{{\emojifont\mdseries\upshape âœï¸}}
\newcommand{\readicon}{{\emojifont\mdseries\upshape ğŸ“–}}
\newcommand{\warningicon}{{\emojifont\mdseries\upshape âš ï¸}}
\newcommand{\tipicon}{{\emojifont\mdseries\upshape ğŸ’¡}}
\newcommand{\keyicon}{{\emojifont\mdseries\upshape ğŸ”‘}}
\newcommand{\soundicon}{{\emojifont\mdseries\upshape ğŸ”Š}}

% Box for British Culture Notes
\newtcolorbox{britishbox}[1][]{
    colback=blue!5,
    colframe=red!60!blue,
    fonttitle=\bfseries,
    title=\britishflag\ British Culture Note,
    #1
}

% Box for Pronunciation
\newtcolorbox{pronunciationbox}[1][]{
    colback=purple!5,
    colframe=purple!60!black,
    fonttitle=\bfseries,
    title=\soundicon\ Pronunciation,
    #1
}

% Box for Comparisons (British vs American)
\newtcolorbox{comparisonbox}[1][]{
    colback=green!5,
    colframe=green!60!black,
    fonttitle=\bfseries,
    title=British vs American English,
    #1
}

% Box for Spanish Speaker Notes
\newtcolorbox{spanishbox}[1][]{
    colback=yellow!10,
    colframe=red!70!black,
    fonttitle=\bfseries,
    title=For Spanish Speakers,
    #1
}

% ============================================
% Custom Title Page for Kaplan
% ============================================
\newcommand{\makekaplantitle}{%
    \begin{titlepage}
        \centering

        % Logo
        \includegraphics[width=0.28\textwidth]{kaplan_inc_purple_(4)[1]-2999653380.jpg}\\[1.2cm]

        \noindent\rule{\textwidth}{0.4pt}\vspace{0.4cm}


        % Title Block
        {\huge\bfseries\color{kaplanPurple} Kaplan Course Notes}\par\vspace{0.4cm}
        {\Large English Language}

        \noindent\rule{\textwidth}{0.4pt}\vspace{0.4cm}

        \vfill

        % Metadata
        {\Large Benjamin Figueroa Guzman}\par\vspace{0.2cm}
        {\large \textit{Last updated: \today\ at \currenttime}}

        \noindent\rule{\textwidth}{0.4pt}\vspace{0.4cm}
        
    \end{titlepage}%
}
